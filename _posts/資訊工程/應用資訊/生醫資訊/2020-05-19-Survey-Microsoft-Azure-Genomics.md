---
title: ã€Surveyã€‘Microsoft Azure Genomics
date: 2020-05-19
is_modified: false
categories:
- "æ‡‰ç”¨è³‡è¨Š â€º ç”Ÿé†«è³‡è¨Š"
tags:
- åŸºå› é«”å­¸ Genomics
- Microsoft Azure
--- 
 
å¹´åˆçš„å·¥ä½œè¦æ±‚ï¼Œå°çµ„å°±å››å€‹åŸºå› é›²ç«¯å¹³å°ï¼š [AWS åŸºå› é«”é›²ç«¯é‹ç®—](https://aws.amazon.com/tw/health/genomics/) ã€ [Microsoft Genomics](https://azure.microsoft.com/zh-tw/services/genomics/) ã€ [Cloud Life Sciences BETA ç‰ˆ](https://cloud.google.com/life-sciences?hl=zh-tw) èˆ‡ [é˜¿é‡Œé›² åŸºå› æ•¸æ“šåˆ†æç®¡ç†](https://cn.aliyun.com/solution/healthcare/Genomics) åˆ†é ­é€²è¡Œ surveyã€‚
  
æˆ‘é€™é‚Šè² è²¬ survey [Microsoft Genomics](https://azure.microsoft.com/zh-tw/services/genomics/)ã€‚

<!--more-->


## åŸºå› å®šåºæµç¨‹
<p class="illustration">
    <img src="https://i.imgur.com/SCrZi7c.jpg" alt="DNA">
    DNAï¼ˆåœ–ç‰‡ä¾†æº: <a href="https://pixabay.com/">Pixabay</a>ï¼‰
</p>

åœ¨é–‹å§‹ä¹‹å‰ï¼Œæˆ‘å€‘å…ˆææåŸºå› å®šåºçš„æµç¨‹ã€‚ä¸€èˆ¬ä¾†èªªï¼Œå¾æ¡æª¢ç”Ÿç‰©æ¨£æœ¬åˆ°æœ€çµ‚æå‡ºè®Šç•°å ±å‘Šï¼Œå¯åˆ†æˆä¸‰å€‹éšæ®µã€‚

é€™è£¡æ¡ç”¨ MS åœ¨ [Genomics ç™½çš®æ›¸](https://azure.microsoft.com/mediahandler/files/resourcefiles/accelerate-precision-medicine-with-microsoft-genomics/Accelerate_precision_medicine_with_Microsoft_Genomics.pdf)ä¸­çš„åˆ†é¡å®šç¾©ï¼š

1) **åˆç´šåˆ†æï¼ˆPrimary analysisï¼‰**  
é€™å€‹éšæ®µæœƒå…ˆæª¢æ¸¬æ¡æ¨£çš„ç”Ÿç‰©æ¨£æœ¬ï¼Œå¦‚è¡€æ¶²æˆ–å”¾æ¶²...ç­‰ï¼Œç¶“ç”±å°ˆæ¥­å„€å™¨åˆ†æå¾Œç”¢ç”ŸåŸå§‹è³‡æ–™ã€‚  

æ­¤éšæ®µå¤šåœ¨ç”Ÿç‰©å¯¦é©—å®¤ä¸­é€²è¡Œï¼Œç ”ç©¶å“¡æœƒä½¿ç”¨å®šåºè¨­å‚™å° DNA åºåˆ—é€²è¡Œé¹¼åŸºè­˜åˆ¥ï¼Œä¸¦åŒæ™‚è¨˜éŒ„å®šåºå„€åœ¨é¹¼åŸºè­˜åˆ¥éç¨‹ä¸­çš„ä¿¡å¿ƒç¨‹åº¦ã€‚æœ€çµ‚å®šåºå„€æœƒç”¢ç”Ÿ 30 å€å®šåºæ·±åº¦çš„å®šåºç‰‡æ®µè³‡æ–™ï¼Œé€£åŒå…¶å®ƒçš„è©®é‡‹è³‡æ–™ï¼Œå¦‚å‰›å‰›æ‰€æåˆ°è³ªé‡ä¿¡å¿ƒåˆ†æ•¸ï¼Œä¸€èµ·ç”¢ç”Ÿç´„ 60 GB çš„å£“ç¸®åŸå§‹è³‡æ–™ã€‚
 
2) **æ¬¡ç´šåˆ†æï¼ˆSecondary analysisï¼‰**  
æ­¤éšæ®µæœƒå°‡å®šåºå„€ç”¢ç”Ÿçš„åŸå§‹è³‡æ–™èˆ‡åƒè€ƒåŸºå› é«”é€²è¡Œæ¯”å°ï¼Œä¸¦å°‡æ¨£æœ¬èˆ‡åƒè€ƒåŸºå› é«”ä¸åŒè™•ï¼ŒåŠè®Šç•°ä½é»ï¼Œä¸€ä¸€æ¨™å‡ºã€‚æ­¤éšæ®µå¯ä»¥åœ¨ç´°åˆ†æˆå…©å€‹æ­¥é©Ÿï¼š
1. **æ‰¾åˆ°æ¯”å°ä½ç½®**   
    æ¯å€‹å®šåºç‰‡æ®µå¿…é ˆå¾ 30 å„„å€‹å¯èƒ½ä½ç½®ä¸­æ‰¾çš„åŸæœ¬çš„ä½ç½®ï¼Œæ‰èƒ½èˆ‡åƒè€ƒåŸºå› é«”é€²è¡Œæ¯”å°ã€‚
    
2. **è®Šç•°ä½é»åµæ¸¬**  
    å®ƒæœƒå¾å®šåºç‰‡æ®µèˆ‡åƒè€ƒåŸºå› é«”çš„æ¯”å°çµæœä¸­æ‰¾å‡ºç›¸ç•°è™•ï¼Œä¸¦ç¢ºå®šå®ƒå€‘æ˜¯å®šåºéŒ¯èª¤é‚„æ˜¯æ¨£æœ¬ä¸­çš„çœŸçš„ç”¢ç”Ÿè®Šç•°ã€‚è®Šç•°å¾é»çªè®Šåˆ°çµæ§‹è®Šç•°éƒ½æœ‰å¯èƒ½ã€‚
 
3) **ä¸‰ç´šåˆ†æï¼ˆTertiary analysisï¼‰**  
æ­¤éšæ®µæœƒç‚ºè®Šç•°ä½é»æ·»åŠ æ³¨é‡‹ï¼Œä»¥å”åŠ©è§£é‡‹å…¶ç”Ÿç‰©å­¸æˆ–è‡¨åºŠä¸Šçš„æ„ç¾©ã€‚æœ€çµ‚ç”¢ç”Ÿå ±å‘Šä»¥é—¡æ˜è©²æ¨£æœ¬èˆ‡åƒè€ƒåŸºå› é«”çš„å·®ç•°åŠå…¶å·®ç•°å«ç¾©ã€‚
    
é€™éšæ®µå–æ±ºæ–¼åˆ†æçš„ç›®çš„ä»¥åŠè‡¨åºŠé†«ç”Ÿæˆ–ç ”ç©¶äººå“¡çš„ç¸½é«”æ–¹æ³•ï¼Œæ­¤éšæ®µä½¿ç”¨äº†å„ç¨®å„æ¨£çš„å·¥å…·å’Œè³‡æ–™åº«ã€‚
    
<p class="illustration">
    <img src="https://i.imgur.com/Z4o4ubJ.png" alt="Analysis Pipeline">
    Analysis Pipelineï¼ˆåœ–ç‰‡ä¾†æº: <a href="https://academic.oup.com/clinchem/article/61/1/124/5611448">Bioinformatics for Clinical Next Generation Sequencing</a>ï¼‰
</p>

ä¸éï¼Œé€™åˆ†é¡ä¸æ˜¯çµ•å°çš„ï¼Œæ¯”è¼ƒåƒæ¥­ç•Œçš„æ½›è¦å‰‡ï¼ˆde facto standardï¼‰ã€‚å°±æœ‰æ›¾ç¶“çœ‹éæŠŠ Annotation åˆ—åœ¨æ¬¡ç´šåˆ†æçš„æ­¥é©Ÿä¸­ï¼Œä¾‹å¦‚ï¼šMS Azure å°±åœ¨è‡ªå®¶æä¾›çš„ Databricks [æ–‡ä»¶ä¸­](https://docs.microsoft.com/zh-tw/azure/databricks/applications/genomics/)æè¿° Genomics çš„æ“ä½œæ­¥é©Ÿæ™‚ï¼Œå°±å°‡å®ƒçµ¦åˆ—åœ¨æ¬¡ç´šåˆ†æã€‚

<p class="illustration">
    <img src="https://imgur.com/IC5TYvY.png" alt="Analysis Pipeline">
    MS å…¶ä»–æœå‹™å°±æŠŠå®ƒåˆ†åœ¨æ¬¡ç´šåˆ†æï¼ˆåœ–ç‰‡ä¾†æº: <a href="https://docs.microsoft.com/zh-tw/azure/databricks/applications/genomics/">MS Azure Databricks</a>ï¼‰
</p>



## Microsoft Genomics

å›é ­ä¾†çœ‹é€™æ¬¡çš„ä¸»è§’ - Microsoft Genomicsï¼ŒæŒ‰ç…§å®˜ç¶²çš„ç°¡ä»‹ç¨å¾®å›é¡§ä¸‹ï¼š 


### ç°¡ä»‹
 - **ç›®æ¨™å®¢ç¾¤**  
     ç ”ç©¶å“¡ã€è³‡æ–™ç§‘å­¸å®¶èˆ‡è‡¨åºŠé†«ç”Ÿç­‰å·¥ä½œè€…ã€‚
     
 - **æä¾›æœå‹™**  
     1. é›²ç«¯ Burrows-Wheeler Alignerï¼ˆBWAï¼‰ä»¥åŠåŸºå› é«”åˆ†æå·¥å…·ï¼ˆGenome Analysis Toolkitï¼ŒGATKï¼‰ã€‚
     2. EB è¦æ¨¡å·¥ä½œè² è¼‰çš„è³‡æ–™ä¸­å¿ƒèˆ‡ HPC ç´šçš„ CPUï¼Œæä¾›åˆ†ææ™‚æ‰€éœ€çš„å„²å­˜èˆ‡è¨ˆç®—èƒ½åŠ›ã€‚

 - **ä½¿ç”¨è€…ä»˜è²»**  
     å¯ä»¥ä¾éœ€æ±‚æ“´å……æˆ–ç¸®å°è¦æ¨¡ï¼Œåªéœ€æ”¯ä»˜ä½¿ç”¨åˆ°çš„éƒ¨åˆ†ä»¥é™ä½æˆæœ¬ã€‚
     
 - **è³‡æ–™ç®¡ç†**  
   1. è³‡æ–™çš„æ“ä½œèˆ‡ä¿ç®¡ä½¿ç”¨æœ‰é€šé ISO èªè­‰ä¸¦éµå¾ª HIPAA æ³•è¦ ï¼Œç¢ºä¿æ‚£è€…ç´€éŒ„å’Œå¥åº·è³‡è¨Šçš„éš±ç§ã€‚
   2. [A Practical Guide to Designing Secure Health Solutions using Microsoft Azure](https://azure.microsoft.com/en-us/resources/a-practical-guide-to-designing-secure-health-solutions-using-microsoft-azure/)ã€‚(:cold_sweat:...èª°çœ‹å®Œäº†åˆ†äº«ä¸€ä¸‹å§ï¼è¨˜éŒ„ä¸€ä¸‹æœ‰é€™æ±è¥¿å°±å¥½ï¼Œå¯¦åœ¨æœ‰éœ€è¦å†å›é ­çœ‹å§ã€‚

<p class="illustration">
    <img src="https://i.imgur.com/EsOa8j3.png" alt="Microsoft Genomics">
    Microsoft Genomicsï¼ˆåœ–ç‰‡ä¾†æº: <a href="https://azure.microsoft.com/zh-tw/services/genomics/">Microsoft Azure æˆªåœ–</a>ï¼‰
</p>


**ç°¡å–®ä¾†èªª**  
MS Genomics æä¾›å„²å­˜èˆ‡é‹ç®—ç©ºé–“ï¼Œè®“ä½¿ç”¨è€…åšç„¡éœ€è™•ç†è»Ÿç¡¬é«”ç¶­è­·èˆ‡æ›´æ–°ï¼Œå°±å¯ä»¥åŸ·è¡Œ<mark>æ¬¡ç´šåˆ†æ</mark>ï¼š GATK æ¨™æº–åˆ†ææµç¨‹ã€‚å…¶ä»–çš„é™„åŠ åƒ¹å€¼æ˜¯çªé¡¯åœ¨å„²å­˜çš„å¯é æ€§ã€æ–¹ä¾¿æ€§ã€è¨ˆç®—é€Ÿåº¦èˆ‡è¨ˆåƒ¹æ–¹å¼ä¸Šã€‚

ä¸Šä¸€å¼µä»–å®¶åˆä½œå¤¥ä¼´ [Persistent](https://www.persistent.com/partner-ecosystem/) çš„åœ–ï¼Œé€™å¼µåœ–å¾ˆå¥½çš„è©®é‡‹äº† MS Genomics æ‰€æä¾›çš„æœå‹™ç¯„åœã€‚ä¸‹åœ–ä¸­æ©˜è‰²çš„éƒ¨åˆ†æ˜¯åˆä½œå¤¥ä¼´ Persistent æ‰€æä¾›çš„æœå‹™ï¼Œå¯ä»¥çœ‹å‡ºä¾†æ˜¯é‡å°ä¸‰ç´šåˆ†æèˆ‡äºŒç´šåˆ†æçš„è¼¸å‡ºçµæœé€²è¡Œè¡¡é‡ï¼Œé€™ä¹Ÿæ˜¯ç¬¬ä¸‰æ–¹æ‰€èƒ½åšçš„éƒ¨ä»½ï¼›è€Œéµç°è‰²çš„éƒ¨åˆ†å‰‡æ˜¯MS Genomics æ‰€æä¾›çš„æ¬¡ç´šåˆ†ææœå‹™ã€‚

<p class="illustration">
    <img src="https://i.imgur.com/aVzl6bv.jpg" alt="Persistent Analysis Pipeline">
    ç°è‰²åº•çš„ç‚º MS Genomics æ‰€æä¾›çš„æœå‹™ï¼Œæ©˜è‰²åº•å‰‡ç‚º Persistent æ‰€æä¾›çš„æœå‹™ï¼ˆåœ–ç‰‡ä¾†æº: <a href="https://www.persistent.com/partner-ecosystem/microsoft/genomics-and-azure/">Persistent Systems</a>ï¼‰
</p>

é‚„æœ‰ä¸€å¼µæˆ‘è¦ºå¾—ä¹Ÿå¯ä»¥çš„èªªæ˜åœ–ï¼Œä½†æˆ‘ä¸æ›‰å¾—è¦å¡å“ªè£¡ ğŸ˜‚ ï¼Œåªèƒ½å…ˆæ”¾é€™ä¹‹å¾Œå†çœ‹çœ‹è¦å¡å“ªè£¡å§ XDDD
<p class="illustration">
    <img src="https://i.imgur.com/jjZ8wwi.png" alt="Persistent Analysis Pipeline">
    Microsoft Genomics Serviceï¼ˆåœ–ç‰‡ä¾†æº: <a href="https://www.microsoft.com/en-us/genomics/">Microsoft Genomics</a>ï¼‰
</p>


### ç³»çµ±æ¶æ§‹
ç³»çµ±æ¶æ§‹åˆ†æˆå…©éƒ¨åˆ†ä¾†çœ‹ï¼Œå…ˆçœ‹ Microsoft Genomics å…§éƒ¨çš„æ¶æ§‹ï¼Œæ¥ä¸‹ä¾†å†ä¾†çœ‹æ•´é«”çš„å·¥ä½œæµç¨‹ã€‚


#### å…§éƒ¨æ¶æ§‹
Microsoft Genomics ç³»çµ±ç”±ä¸Šè€Œä¸‹ç¸½å…±å¯åˆ†ç‚ºä¸‰å€‹éƒ¨åˆ†ï¼Œåˆ†åˆ¥æ˜¯ï¼šService Controllerã€SNAP Engineã€SNAP Engine èˆ‡æ¬¡ç´šåˆ†æçš„ pipline - BWA-MEM & GATK HaplotypeCallerã€‚

<p class="illustration">
    <img src="https://i.imgur.com/qgJIlqx.png" alt="Architecture">
    Microsoft Genomics Architectureï¼ˆåœ–ç‰‡ä¾†æº: <a href="https://azure.microsoft.com/mediahandler/files/resourcefiles/accelerate-precision-medicine-with-microsoft-genomics/Accelerate_precision_medicine_with_Microsoft_Genomics.pdf">ç™½çš®æ›¸</a>ï¼‰
</p>


**Service Controller**  
æ­¤å€å¡Šæ˜¯ç”¨ä¾†ç®¡ç†åˆ†å¸ƒåœ¨æ©Ÿå™¨é›†å€ï¼ˆpools of machinesï¼‰è£¡çš„ä¸€æ‰¹åŸºå› é«”çš„è™•ç†ï¼Œä¸»è¦ç”¨æ¥æ”¶ API è«‹æ±‚ã€å®‰æ’å·¥ä½œä½‡åˆ—ä»¥åŠç®¡ç† Azure Batch ä¸­è·¨æ©Ÿå™¨é›†å€çš„åŸ·è¡Œã€‚

å‰ç«¯æœƒæ¥å—ä¾†è‡ª Azure API çš„è«‹æ±‚ï¼Œä¸¦å°‡å®ƒæ”¾ç½®åœ¨å·¥ä½œä½‡åˆ—ä¸­ã€‚è€Œ Web Job Application å‰‡æœƒç‚ºä½‡åˆ—ä¸­æ¯å€‹é …ç›®é€²è¡Œæ’ç¨‹ï¼Œå°‡å®ƒå€‘åˆ†ç™¼åˆ°é‹è¡ŒåŸºå› é«”å¼•æ“çš„ä¼ºæœå™¨ï¼Œä¸¦ç›£è¦–å…¶æ€§èƒ½èˆ‡é€²åº¦ï¼Œæœ€å¾Œè©•ä¼°çµæœã€‚

ç•¶ Azure Batch åŸ·è¡Œä»»å‹™æ™‚ï¼Œservice executable ä¸‹è¼‰åƒè€ƒè³‡æ–™å’Œè¼¸å…¥æ–‡ä»¶ï¼Œä¸¦åŸ·è¡Œ SNAP å¼•æ“ï¼Œå†å°‡çµæœå¯«å…¥æ–‡ä»¶æµå›åˆ° Azure Storageï¼Œæœ€å¾Œå ±å‘Šå®Œæˆæƒ…æ³ã€‚

æœ€å¾Œçš„åˆ†æçµæœæ¥è‘—å‘ä¸‹åšä¸‰ç´šåˆ†æå’Œæˆ–æ˜¯å…¶ä»–æ©Ÿå™¨å­¸ç¿’ã€‚

<br class="big">

**SNAP Engine**  
SNAP Engine é€™æ˜¯ Microsoft Research èˆ‡ UC Berkeley AMPLab ä¸€èµ·åˆä½œé–‹ç™¼çš„ [SNAP short read aligner](http://snap.cs.berkeley.edu/#publications)ã€‚ä¸éæ­¤ç‰ˆæœ¬ä¸ä½¿ç”¨ SNAP alignment æ¼”ç®—æ³•ï¼Œè€Œæ˜¯æ”¹æ¡ BWA MEMã€‚ä¸»è¦ç”¨ä¾†è¦åŠƒå–®ä¸€æ¨£æœ¬æ–¼å–®ä¸€æ©Ÿå™¨ä¸Šçš„ IO èˆ‡æ‰€æœ‰è¨ˆç®—çš„æµç¨‹ã€‚ã€‚

~~(...æ©ï¼Œæ‰€ä»¥æŠŠ SNAP æ ¸å¿ƒæ¼”ç®—æ³•å¼„æ‰äº†ï¼Œç‚ºå•¥é‚„å« SNAP Engineï¼Ÿ)~~

<p class="illustration">
    <img src="https://i.imgur.com/fq0zMBR.png" alt=" Standard BWA/GATK Pipeline">
    Standard BWA/GATK Pipelineï¼ˆåœ–ç‰‡ä¾†æº: <a href="https://azure.microsoft.com/mediahandler/files/resourcefiles/accelerate-precision-medicine-with-microsoft-genomics/Accelerate_precision_medicine_with_Microsoft_Genomics.pdf">ç™½çš®æ›¸</a>ï¼‰
</p>

é€™æ˜¯ä¸€å¼µ GATK çš„æ¨™æº–æµç¨‹ï¼Œæ¯å€‹ç¶ è‰²å€å¡Šä¹‹é–“éƒ½é€²è¡Œäº†ä¸€æ¬¡è®€å¯«å‹•ä½œã€‚è€Œ SNAP Engine å®£ç¨±å®ƒå…·æœ‰ä¸€å€‹éåŒæ­¥è¼¸å…¥/è¼¸å‡ºå­ç³»çµ±ï¼Œå¯æœ‰æ•ˆè™•ç†å¤§é‡åŸºå› é«”è³‡æ–™ï¼Œä¸¦æ’ç¨‹è·¨å¤šæ ¸å¿ƒçš„è¨ˆç®—å¯†é›†å‹å·¥ä½œä¸¦æ”¶é›†çµæœã€‚

ç‚ºäº†å„˜é‡æ¸›å°‘ç¡¬ç¢Ÿè®€å–æ¬¡æ•¸ï¼Œä»–å€‘æ”¹è‰¯äº† pipeline çš„æµç¨‹åªé€²è¡Œå…©æ¬¡çš„è®€å¯«å‹•ä½œï¼Œæ¸›å°‘äº†æ¨™æº– BWA/GATK pipline ä¸­çš„è®€å¯«æ¬¡æ•¸ã€‚

<p class="illustration">
    <img src="https://i.imgur.com/BFgcc8q.png" alt=" Microsoft Genomics Pipeline">
    Standard BWA/GATK Pipelineï¼ˆåœ–ç‰‡ä¾†æº: <a href="https://azure.microsoft.com/mediahandler/files/resourcefiles/accelerate-precision-medicine-with-microsoft-genomics/Accelerate_precision_medicine_with_Microsoft_Genomics.pdf">ç™½çš®æ›¸</a>ï¼‰
</p>

å¯ä»¥çœ‹åˆ°æ”¹è‰¯å¾Œçš„ pipeline æœƒåˆ†æˆå…©å€‹éšæ®µï¼Œåœ¨ç¬¬ä¸€éšæ®µæ˜¯è·¨æ‰€æœ‰æ ¸å¿ƒé€²è¡Œå¤§é‡æ‰¹æ¬¡å®šåºç‰‡æ®µæ¯”å°ï¼›ä½†ç‰¹åˆ¥çš„æ˜¯ï¼Œé€²è¡Œå‰è™•ç†æ™‚ä¸ä¾è³´ä»»ä½•çš„æ’åºï¼Œä¾‹å¦‚ï¼šæ”¶é›†ç”¨ä¾†åšå®šåºè³ªé‡åˆ†æ•¸é‡æ–°æ ¡æ­£çš„çµ±è¨ˆè³‡æ–™ã€‚å®Œæˆå¾Œï¼Œå°‡å®šåºç‰‡æ®µä¾åºæ‰¹æ¬¡å¯«å…¥ä¸­é–“æ–‡ä»¶ã€‚

ç¬¬äºŒéšæ®µå°‡æ‰€æœ‰ batches åˆä½µåˆ°ä¸€å€‹å®šåºç‰‡æ®µçš„ single fully-sorted stream ä¸­ï¼Œä¸¦å®Œæˆé è™•ç†å’Œå¾Œè™•ç†æ­¥é©Ÿï¼šæ‡‰ç”¨ BQSR çµ±è¨ˆä¿¡æ¯ã€æ¨™è¨˜é‡è¤‡é …ã€æ§‹å»º BAM ç´¢å¼•ä»¥åŠå£“ç¸® BAM æ–‡ä»¶ã€‚

åœ¨ç·¨å¯« BAM æ–‡ä»¶çš„åŒæ™‚ï¼Œæ­¤éšæ®µé‚„å”èª¿äº†å¹¾å€‹ GATK æµç¨‹ä¾†é€²è¡Œè®Šç•°é»åµæ¸¬ï¼Œè­˜åˆ¥æ½›åœ¨è®Šç•°é»é™„è¿‘çš„æ¿€æ´»å€åŸŸï¼Œä¸¦åƒ…å°‡é‚£äº›å®šåºç‰‡æ®µç›´æ¥è¼¸é€åˆ° HaplotypeCaller ä¸­ä»¥æé«˜æ•ˆç‡ã€‚ç”±æ–¼æ’åºæ˜¯ IO å¯†é›†å‹çš„ï¼Œè€Œè®Šç•°é»åµæ¸¬æ˜¯ CPU å¯†é›†å‹çš„ï¼Œå› æ­¤å¯ä»¥æœ‰æ•ˆåœ°å¹³è¡¡æ©Ÿå™¨è³‡æºçš„æ•´é«”ä½¿ç”¨ã€‚

æ¨™æº–çš„ GATK åˆ†ææµç¨‹ç®¡ç·šä¸­é€šå¸¸æŒ‰é †åºåŸ·è¡Œæ¯å€‹æ­¥é©Ÿã€‚æ¯å€‹æ­¥é©Ÿéƒ½å¿…é ˆè®€å…¥ä¸Šä¸€æ­¥ç”Ÿæˆçš„æ–‡ä»¶ï¼Œå› æ­¤å¿…é ˆç­‰å¾…å®ƒå®Œæˆã€‚å¦‚åœ– 2 æ‰€ç¤ºï¼Œè‹¥å°‡å·¥ä½œä¾åŸºå› é«”çš„ä¸åŒå€åŸŸåˆ†é€²è¡ŒåŠƒåˆ†ï¼Œå‰‡åœ¨ä¸€å€‹æ­¥é©Ÿä¸­å°±æœƒå­˜åœ¨å¹³è¡Œæ€§å¯èƒ½ï¼ˆä¾‹å¦‚ï¼šåˆ†åˆ¥åœ¨æ¯å€‹æŸ“è‰²é«”ä¸Šé‹è¡Œ MarkDuplicatesï¼‰ã€‚

æ ¹æ“š[å¾®è»Ÿçš„åˆä½œå¤¥ä¼´è¡¨ç¤º](http://info.microsoft.com/rs/157-GQE-382/images/EN-CNTNT-ebook-PartneringToAdvanceClinicalGenomics.pdf)ï¼Œæ•´å¥—æ¬¡ç´šåˆ†æçš„æ™‚é–“æœƒç”±åŸå…ˆçš„ 28 å°æ™‚é™è‡³ 4 å°æ™‚ï¼Œåƒ…éœ€åŸå…ˆæ™‚é–“çš„ 1/7 ã€‚
 
<br class="big">

**BWA-MEM & GATK HaplotypeCaller**   
å…ˆæä¸€ä¸‹ HaplotypeCaller çš„æ ¸å¿ƒæ“ä½œå°±æ˜¯å››æ­¥ï¼š

1. å°‹æ‰¾æ¿€æ´»å€åŸŸï¼Œå°±æ˜¯å’Œåƒè€ƒåŸºå› é«”ä¸åŒéƒ¨åˆ†è¼ƒå¤šçš„å€åŸŸã€‚
2. é€šéå°è©²å€åŸŸé€²è¡Œå±€éƒ¨é‡çµ„è£ï¼Œç¢ºå®šå–®å€å‹ï¼ˆhaplotypesï¼‰ã€‚å°±æ˜¯é€™ä¸€æ­¥å¯ä»¥çœå» indel realignmentï¼
3. åœ¨çµ¦å®šçš„readæ•¸æ“šä¸‹ï¼Œè¨ˆç®—å–®å€å‹çš„å¯èƒ½æ€§ã€‚
4. åˆ†é…æ¨£æœ¬çš„åŸºå› å‹ã€‚

åœ¨é€™è£¡ BWAMEM å’Œ GATK HaplotypeCaller å¤§éƒ¨åˆ†çš„ç¨‹å¼ç¢¼ä¿æŒä¸è®Šï¼Œä»¥ç¢ºä¿èˆ‡æ¨™æº– pipelines çš„å…¼å®¹æ€§ã€‚åƒ…å°‘é‡ä¿®æ”¹é å…ˆè¨ˆç®—çš„æ¿€æ´»å€åŸŸé€šé pipelines è¼¸å…¥åˆ°æ¨™æº– input ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸Šè¿°æåˆ°çš„ç¬¬ä¸€æ­¥é©Ÿï¼Œå› ç‚ºé€™æ­¥é©Ÿæ²’æœ‰ç›¸ä¾æ€§ï¼Œæ•…å¯ä»¥æ‹†é–‹ä¾†åšã€‚


#### æ•´é«”çš„å·¥ä½œæµç¨‹
<p class="illustration">
    <img src="https://i.imgur.com/Vtv8sER.png" alt="Microsoft Azure workflow">
    Microsoft Azure workflowï¼ˆåœ–ç‰‡ä¾†æº: <a href="https://github.com/microsoft/CromwellOnAzure">
CromwellOnAzure</a>ï¼‰
</p>

ç”±æ‰¾åˆ°çš„æµç¨‹åœ–çœ‹ä¾†ï¼Œä»–å€‘å¾Œé¢ç”¨çš„ Cromwellï¼Œä¸éæ˜¯æœ‰ç¶“éå®¢è£½åŒ–ï¼Œç¨±ä½œ[Cromwell on Azure](https://github.com/microsoft/CromwellOnAzure)ï¼Œæ­é… TES æœ€å›å¾Œç«¯ä¾†èª¿ç”¨ Azure Batch ã€‚è‹¥æ˜¯å°å›æœå‹™å…§éƒ¨çš„æ¶æ§‹ä¾†çœ‹ï¼Œè¢«æˆ‘æš±ç¨±é£›å¤©è±¬+TESçš„é€™éƒ¨åˆ†ï¼Œæœƒå°ç…§å› Service Controllerã€‚

<div class="alert warning">
è¶Šå¯«è¶Šä¸ç¢ºå®š SNAP Engineï¼Œ æ˜¯å°ç…§çš„åœ–ä¸­çš„å“ªä¸€å¡Šã€‚

åŸæœ¬æ¨æ¸¬ SNAP Engine æ˜¯å±¬æ–¼ Trigger Service çš„éƒ¨åˆ†ï¼Œä½†å¾Œä¾†åˆè¦ºå¾—çš„æ˜¯ compute environment ä¸Šçš„ VM ï¼Œå› ç‚ºæ–‡ä»¶ä¸­å°å®ƒæè¿°æ˜¯ï¼šã€Œè¦åŠƒå–®ä¸€æ¨£æœ¬æ–¼å–®ä¸€æ©Ÿå™¨ä¸Šæµç¨‹ã€ã€‚
</div>

è‡³æ–¼ WDL å‰‡æ˜¯ä¸‹ä¸€å¼µæœƒæåˆ°çš„ msgenã€‚


### åŸ·è¡Œ Microsoft Genomics æœå‹™
å…¶å¯¦é€™é‚Šæœ‰å¦‚æœéœ€è¦ä»¥ç›´æ¥çœ‹ MS Genomics çš„[å®˜æ–¹æ–‡ä»¶](https://docs.microsoft.com/zh-tw/azure/genomics/quickstart-run-genomics-workflow-portal)ã€‚è‹¥æ˜¯æƒ³è¦çœ‹åœ–æ–‡æ‰‹æŠŠæ‰‹æ•™å­¸ï¼Œå¯ä»¥çœ‹çœ‹é€™ç¯‡ã€Š[æ¬¡ä¸–ä»£å®šåºäºŒæ¬¡åˆ†æ Microsoft Azure Genomics](https://medium.com/@102316115/%E6%AC%A1%E4%B8%96%E4%BB%A3%E5%AE%9A%E5%BA%8F%E4%BA%8C%E6%AC%A1%E5%88%86%E6%9E%90microsoft-azure-genomics-77f2cc4994b6)ã€‹ã€‚

<br class="big"> 

ä¸éé€™é‚Šé‚„æ˜¯ç•™ä¸€ä¸‹ç´€éŒ„ï¼š

#### äº‹å‰æº–å‚™
1. Azure å¸³æˆ¶ ~~(å»¢è©±)~~ï¼Œä¸¦æº–å‚™ **Azure Blob å„²å­˜é«”** å¸³æˆ¶èˆ‡ **Microsoft Genomics** å¸³æˆ¶ã€‚
2. æº–å‚™åŸºå› è³‡æ–™ FASTQ æˆ–æ˜¯ BAM æ ¼å¼çš†å¯ã€‚
3. å®‰è£ pip èˆ‡ [Python 2.7.12+](https://www.python.org/downloads/release/python-2714/)ã€‚  

    <div class="alert danger">
    <div class="head">æ³¨æ„</div>
    æ˜¯å®‰è£ Python 2 ä¸æ˜¯ Python 3ï¼Œå…©è€…ä¸ç›¸å®¹ã€‚     
    </div>


#### åŸ·è¡Œæ­¥é©Ÿ
1. è¨­å®šï¼š
    1. è‹¥æ²’æœ‰ Microsoft Genomics å¸³æˆ¶è«‹[åƒè€ƒæ•™å­¸æ–‡ä»¶](https://docs.microsoft.com/zh-tw/azure/genomics/quickstart-run-genomics-workflow-portal#set-up-create-a-microsoft-genomics-account-in-the-azure-portal)ã€‚
    2. å®‰è£ [Microsoft Genomics å‘½ä»¤åˆ—ä»‹é¢](https://github.com/MicrosoftGenomics/msgen)ã€‚
    ```shell
    $ pip install --upgrade --no-deps msgen
    $ pip install msgen
    ```

2. ä¸Šå‚³è¼¸å…¥æª”æ¡ˆï¼š
    1. è‹¥æ²’æœ‰  Microsoft Azure å„²å­˜é«”å¸³æˆ¶è«‹[åƒè€ƒæ•™å­¸æ–‡ä»¶](https://docs.microsoft.com/zh-tw/azure/genomics/quickstart-run-genomics-workflow-portal#create-a-microsoft-azure-storage-account)ã€‚
    2. å°‡æº–å‚™å¥½çš„åŸºå› é…å° (fastq æˆ– bam æª”æ¡ˆ)ä¸Šå‚³åˆ°å„²å­˜é«”ã€‚é€™é‚Šæœ‰å…¬é–‹çš„ç¯„ä¾‹è³‡æ–™å¯ç”¨ï¼š 
        - https://msgensampledata.blob.core.windows.net/small/chr21_1.fq.gz
        - https://msgensampledata.blob.core.windows.net/small/chr21_2.fq.gz
     
3. åŸ·è¡Œï¼š
    1. è¨­å®š `config.txt` æª”æ¡ˆï¼Œä¸»è¦æ˜¯å¿…é ˆåŒ…å«ï¼šè¨‚ç”¨å¸³æˆ¶é‡‘é‘°ã€å„²å­˜é«”å¸³æˆ¶åç¨±ã€è¼¸å…¥å’Œè¼¸å‡ºçš„é‡‘é‘°èˆ‡å®¹å™¨åç¨±ã€‚
    2. æœ€å¾Œå°±å¯ä»¥é€é Microsoft Genomics å‘½ä»¤åˆ—ä»‹é¢æäº¤å·¥ä½œæµç¨‹ã€‚
        ```shell
        $ msgen submit -f [full path to your config file] -b1 [name of your first paired end read] -b2 [name of your second paired end read]
        ```
        å·¥ä½œç‹€æ…‹çš„æª¢è¦–
        ```shell
        $ msgen list -f c:\temp\config.txt
        ```


#### æ³¨æ„èˆ‡é™åˆ¶
1. [Microsoft Genomics å‘½ä»¤åˆ—ä»‹é¢](https://github.com/MicrosoftGenomics/msgen)çœ‹ä¾†æ˜¯ MS åŒ…è£å¥½ WDLï¼Œä½†æ ¹æ“šèªªæ˜èƒ½æ”¹å‹•çš„ä¼¼ä¹ä¸å¤šï¼š
    1. å¯å°‡ process_name åƒæ•¸è¨­å®šç‚º gatk4 ä»¥æ”¹æˆï¼Œä»¥åŸ·è¡Œ GATK4ã€‚
    2. æ–°å¢ emit_ref_confidence åƒæ•¸è¨­å®šç‚º gvcfï¼Œä»¥è¼¸å‡º gvcfã€‚
2. ç„¡æ³•æäº¤<mark>å¤šå€‹å€‹é«”</mark>çš„ FASTQ æˆ– BAM æª”æ¡ˆï¼Œæ‰€ä»¥è‹¥è¦åˆ†æå¤šå€‹å€‹é«”è³‡æ–™åªèƒ½åˆ†åˆ¥ä¸‹æŒ‡ä»¤ã€‚

<br class="big">

ä¸éè·ŸåŒäº‹è¨è«–äº†ä¸€ä¸‹ï¼ŒMS é€™å¥— WDL çš„è¨­è¨ˆæ‡‰è©²æ˜¯å…ˆå‰ Survey çš„è³‡è¨Šä¸€æ¨£ï¼Œæ˜¯ç‚ºäº†ç ”ç©¶å“¡æˆ–è‡¨åºŠé†«ç”Ÿé€™äº›éè³‡è¨ŠèƒŒæ™¯äººå“¡æ‰€è¨­è¨ˆçš„ï¼Œæ‰€ä»¥è¨­è¨ˆçš„æŒºå¥½ä¸Šæ‰‹çš„ï¼Œä½†ä»£åƒ¹å°±æ˜¯å¯ä»¥ä¿®æ”¹çš„åœ°æ–¹ä¸å¤šã€‚

çœ‹èµ·ä¾†æ•´å¥—çš„æ ¸å¿ƒå°±æ˜¯ï¼ŒController çš„ Batch ç›£æ§èˆ‡ Engine çš„ç”¨è·¨å¤šæ ¸å¿ƒçš„è¨ˆç®—å¯†é›†å‹å·¥ä½œæ’ç¨‹ä¸¦çµæœå›æ”¶ï¼Œå…¶å¯¦é€™å…©å€å¡Šè¦åˆ»æ‡‰è©²ä¹Ÿæ˜¯å¯ä»¥ï¼Œä½†å·¥æœƒéå¸¸çš„å¤§ã€‚é€™é‚Šæ‡‰è©²æœ‰è¾¦æ³•å¯ä»¥ä¸å€ŸåŠ© msgen è‡ªå·±æ’°å¯« WDL æ‰å°(ä¸è² è²¬ä»»çŒœæ¸¬ã€‚ 

 

## ä½¿ç”¨æ¡ˆä¾‹
é€™é‚Šå°±ä¸å¯«äº†ï¼Œç›´æ¥çœ‹é€™ä»½ã€Š[Partnering to Advance Clinical Genomics](http://info.microsoft.com/rs/157-GQE-382/images/EN-CNTNT-ebook-PartneringToAdvanceClinicalGenomics.pdf)ã€‹ ã€‚

å°±ç›®å‰ servey çœ‹ä¾†å¹¾å€‹åŸºå› é›²ç«¯å¹³å°æœ€å¤šäººä½¿ç”¨çš„ä¾åºåˆ†åˆ¥ç‚ºï¼šAWS > Azure > googleã€‚



## åƒè€ƒè³‡æ–™ 
1. æå»ºèˆˆ (2018-03-01)ã€‚[åŸºå› å®šåºä¹Ÿè¦ä¸Šé›²ï¼Œå¾®è»Ÿç™¼è¡¨åŸºæ–¼Azureçš„Microsoft Genomics](https://www.ithome.com.tw/news/121565) ã€‚æª¢è‡ª iThome (2020-02-10)ã€‚
2. [Genomics - Azure Databricks](https://docs.microsoft.com/zh-tw/azure/databricks/applications/genomics/)ã€‚æª¢è‡ª Microsoft Docs (2020-02-10)ã€‚
3. [Microsoft Genomics æ”¯æ´åŸºå› çµ„å®šåºåŠç ”ç©¶æ·±å…¥è§£æ](https://azure.microsoft.com/zh-tw/services/genomics/)ã€‚æª¢è‡ª Microsoft Azure (2020-02-10)ã€‚
4. [Accelerate precision medicine with Microsoft Genomics](https://azure.microsoft.com/mediahandler/files/resourcefiles/accelerate-precision-medicine-with-microsoft-genomics/Accelerate_precision_medicine_with_Microsoft_Genomics.pdf)ã€‚æª¢è‡ª Microsoft Genomics (2020-02-10)ã€‚
5. [Microsoft Genomics And Azure - Partner EcoSystem](https://www.persistent.com/partner-ecosystem/microsoft/genomics-and-azure/)ã€‚æª¢è‡ª Persistent Systems (2020-02-10)ã€‚
6. [microsoft/CromwellOnAzure](https://github.com/microsoft/CromwellOnAzure)ã€‚æª¢è‡ª Github  (2020-02-10)ã€‚
7. [amplab/snap](https://github.com/amplab/snap)ã€‚æª¢è‡ª Github  (2020-02-10)ã€‚
8. [SNAP Scalable Nucleotide Alignment Program](http://snap.cs.berkeley.edu/#publications)ã€‚æª¢è‡ª UC Berkeley AMP Lab (2020-02-10)ã€‚
9. [Partnering to Advance Clinical Genomics](http://info.microsoft.com/rs/157-GQE-382/images/EN-CNTNT-ebook-PartneringToAdvanceClinicalGenomics.pdf)ã€‚æª¢è‡ª Microsoft Genomics (2020-02-10)ã€‚
10. hoptop(2017-05-03)ã€‚ [GATKä¹‹HaplotypeCaller](http://www.biotrainee.com/thread-1417-1-1.html)ã€‚æª¢è‡ª ç”Ÿä¿¡æŠ€èƒ½æ ‘ (2020-02-10)ã€‚
11. [Scalable and Secure Genomic Data Analysis on Azure](https://www.microsoft.com/en-us/genomics/)ã€‚æª¢è‡ª Microsoft Genomics (2020-02-10)ã€‚
12. Chaitanya Bangur (2019-10-11)ã€‚[Powering genomics tools and analysis with cloud computing](https://cloudblogs.microsoft.com/industry-blog/health/2019/10/11/powering-genomics-tools-and-analysis-with-cloud-computing/) ã€‚æª¢è‡ª Microsoft Industry Blogs (2020-02-10)ã€‚
13. Todd Bergeson (2018-04-17)ã€‚[Leveraging the power of cloud computing to fuel genomic research](https://cloudblogs.microsoft.com/industry-blog/health/2018/04/17/leveraging-the-power-of-cloud-computing-to-fuel-genomic-research/) ã€‚æª¢è‡ª Microsoft Industry Blogs (2020-02-10)ã€‚ 
14. [A Practical Guide to DESIGNING SECURE HEALTH SOLUTIONS Using Microsoft Azure](https://aka.ms/azureindustrysecurity)ã€‚æª¢è‡ª Microsoft Genomics (2020-02-10)ã€‚
15. Amazon Web Services (2018-07-02)ã€‚[Accelerating Analytics for the Future of Genomics](https://www.slideshare.net/AmazonWebServices/accelerating-analytics-for-the-future-of-genomics)ã€‚æª¢è‡ª SlideShare (2020-02-10)ã€‚
16. Brannann (2019-07-29)ã€‚[æ¬¡ä¸–ä»£å®šåºäºŒæ¬¡åˆ†æMicrosoft Azure Genomics](https://medium.com/@102316115/%E6%AC%A1%E4%B8%96%E4%BB%A3%E5%AE%9A%E5%BA%8F%E4%BA%8C%E6%AC%A1%E5%88%86%E6%9E%90microsoft-azure-genomics-77f2cc4994b6)ã€‚æª¢è‡ª Brannann - Medium (2020-02-10)ã€‚
17. Jenn Roth (2018-04-26)ã€‚[Maximizing the value of genomic data in healthcare](https://cloudblogs.microsoft.com/industry-blog/health/2018/04/26/maximizing-the-value-of-genomic-data-in-healthcare/)ã€‚æª¢è‡ª Microsoft Genomics (2020-02-10)ã€‚



## æ›´æ–°ç´€éŒ„
<details class="update_stamp">
  <summary>æœ€å¾Œæ›´æ–°æ—¥æœŸï¼š2020-05-19</summary>
  <ul>
    <li>2020-05-19 ç™¼è¡¨</li>
    <li>2020-02-10 å®Œç¨¿</li>
  </ul>
</details>